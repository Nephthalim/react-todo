{"ast":null,"code":"import _slicedToArray from\"/Users/nephthalimabebe/Desktop/react-todo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useHistory}from'react-router-dom';import Navbar from'../components/Dashboard/Navbar';import NewTaskButton from'../components/Dashboard/NewTaskButton';import TodoList from'../components/Dashboard/TodoList';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var DashboardPage=function DashboardPage(_ref){var setAuthentication=_ref.setAuthentication;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),todoList=_useState2[0],setTodoList=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState({name:\"\"}),_useState6=_slicedToArray(_useState5,2),user=_useState6[0],setUser=_useState6[1];var token=localStorage.getItem(\"token\");var getUser=function getUser(){fetch(\"/todo\",{method:'GET',headers:{'token':token,'Content-Type':'application/json','Accept':'application/json'}}).then(function(res){if(res.status===200)return res.json();else if(res.status===403){localStorage.removeItem('token');setAuthentication(false);}}).then(function(data){setUser({name:data.name});}).catch(function(err){console.log(err);localStorage.removeItem('token');setAuthentication(false);});};var getTodoList=function getTodoList(){fetch(\"/todo/all\",{method:'GET',headers:{'token':token,'Content-Type':'application/json','Accept':'application/json'}}).then(function(res){return res.json();}).then(function(data){setTodoList(data.todos);}).catch(function(err){console.log(err);localStorage.removeItem('token');setAuthentication(false);});};var searchTask=function searchTask(searchQuery){fetch('/todo/search?query='+searchQuery.query,{method:\"GET\",headers:{'Content-Type':'application/json','Accept':'application/json',\"token\":token}}).then(function(res){return res.json();}).then(function(data){setTodoList(data.searchResult);}).catch(function(err){localStorage.removeItem('token');setAuthentication(false);});};var deleteTodo=function deleteTodo(id){setTodoList(todoList.filter(function(todo){return todo.id!==id;}));};useEffect(function(){setIsLoading(true);getUser();getTodoList();setIsLoading(false);},[]);if(isLoading){return/*#__PURE__*/_jsx(\"section\",{children:/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"})});}else{return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{name:user.name,setAuthentication:setAuthentication,searchTask:searchTask}),/*#__PURE__*/_jsx(TodoList,{todos:todoList,deleteTodo:deleteTodo}),/*#__PURE__*/_jsx(NewTaskButton,{setTodos:setTodoList,todos:todoList})]});}};export default DashboardPage;","map":{"version":3,"sources":["/Users/nephthalimabebe/Desktop/react-todo/client/src/pages/DashboardPage.js"],"names":["React","useState","useEffect","useHistory","Navbar","NewTaskButton","TodoList","DashboardPage","setAuthentication","todoList","setTodoList","isLoading","setIsLoading","name","user","setUser","token","localStorage","getItem","getUser","fetch","method","headers","then","res","status","json","removeItem","data","catch","err","console","log","getTodoList","todos","searchTask","searchQuery","query","searchResult","deleteTodo","id","filter","todo"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { useHistory } from 'react-router-dom'\n\nimport Navbar from '../components/Dashboard/Navbar'\nimport NewTaskButton from '../components/Dashboard/NewTaskButton'\nimport TodoList from '../components/Dashboard/TodoList'\n\nconst DashboardPage = ({ setAuthentication }) => {\n\n    const [todoList, setTodoList] = useState([]);\n    const [isLoading, setIsLoading] = useState(true);\n    const [user, setUser] = useState({ name: \"\" });\n    const token = localStorage.getItem(\"token\")\n\n    const getUser = () => {\n        fetch(\"/todo\",\n            {\n                method: 'GET',\n                headers: {\n                    'token': token,\n                    'Content-Type': 'application/json',\n                    'Accept': 'application/json',\n                }\n            }\n\n        ).then((res) => {\n            if (res.status === 200) return res.json();\n            else if (res.status === 403) {\n                localStorage.removeItem('token')\n                setAuthentication(false)\n            }\n        }).then((data) => {\n            setUser({ name: data.name })\n\n        }).catch((err) => {\n            console.log(err)\n            localStorage.removeItem('token')\n            setAuthentication(false)\n        })\n    }\n    const getTodoList = () => {\n        fetch(\"/todo/all\",\n            {\n                method: 'GET',\n                headers: {\n                    'token': token,\n                    'Content-Type': 'application/json',\n                    'Accept': 'application/json'\n                }\n            }\n        ).then((res) => {\n            return res.json();\n        }).then((data) => {\n            setTodoList(data.todos)\n        }).catch((err) => {\n            console.log(err)\n            localStorage.removeItem('token')\n            setAuthentication(false)\n        })\n\n    }\n\n    const searchTask = (searchQuery) => {\n        fetch('/todo/search?query=' + searchQuery.query,\n            {\n                method: \"GET\",\n                headers:\n                {\n                    'Content-Type': 'application/json',\n                    'Accept': 'application/json',\n                    \"token\": token\n                }\n            }).then((res) => {\n                return res.json()\n            }).then((data) => {\n                setTodoList(data.searchResult)\n            }).catch((err) => {\n                localStorage.removeItem('token')\n                setAuthentication(false)\n            })\n    }\n\n    const deleteTodo = (id) => {\n        setTodoList(todoList.filter(todo => todo.id !== id))\n    }\n\n    useEffect(() => {\n        setIsLoading(true);\n        getUser();\n        getTodoList();\n        setIsLoading(false);\n    }, [])\n    if (isLoading) {\n        return (\n            <section>\n                <p>Loading...</p>\n            </section>\n        );\n    }\n    else {\n        return (\n            <>\n                <Navbar name={user.name} setAuthentication={setAuthentication} searchTask={searchTask} />\n                {/* <Navbar name={\"Nephy\"} setAuthentication={setAuthentication} searchTask={searchTask} /> */}\n                <TodoList todos={todoList} deleteTodo={deleteTodo} />\n                <NewTaskButton setTodos={setTodoList} todos={todoList}/>\n\n\n            </>\n        )\n\n    }\n}\n\nexport default DashboardPage\n"]},"metadata":{},"sourceType":"module"}