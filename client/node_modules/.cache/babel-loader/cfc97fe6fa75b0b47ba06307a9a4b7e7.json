{"ast":null,"code":"import _slicedToArray from\"/Users/nephthalimabebe/Desktop/react-todo/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useHistory}from'react-router-dom';import Navbar from'../components/Dashboard/Navbar';import NewTaskButton from'../components/Dashboard/NewTaskButton';import TodoList from'../components/Dashboard/TodoList';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var DashboardPage=function DashboardPage(_ref){var setAuthentication=_ref.setAuthentication;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),todoList=_useState2[0],setTodoList=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState({name:\"\"}),_useState6=_slicedToArray(_useState5,2),user=_useState6[0],setUser=_useState6[1];var token=localStorage.getItem(\"token\");var url=\"https://nephthalim-react-todo.herokuapp.com\";var getUser=function getUser(){fetch(url+\"/\",{method:'GET',headers:{'token':token}}).then(function(res){if(res.status===200)return res.json();else if(res.status===403){localStorage.removeItem('token');setAuthentication(false);}}).then(function(data){setUser({name:data.name});}).catch(function(err){localStorage.removeItem('token');setAuthentication(false);});};var getTodoList=function getTodoList(){fetch(url+\"/todo\",{method:'GET',headers:{'token':token}}).then(function(res){return res.json();}).then(function(data){setTodoList(data.todos);}).catch(function(err){localStorage.removeItem('token');setAuthentication(false);});};var searchTask=function searchTask(searchQuery){console.log(\"Searching \".concat(searchQuery));fetch(url+'/search?query='+searchQuery.query,{method:\"GET\",headers:{'Content-Type':\"application/json\",\"token\":token}}).then(function(res){return res.json();}).then(function(data){setTodoList(data.searchResult);}).catch(function(err){localStorage.removeItem('token');setAuthentication(false);});};var deleteTodo=function deleteTodo(id){setTodoList(todoList.filter(function(todo){return todo.id!==id;}));};useEffect(function(){console.log(\"DahsboardPage.js\");setIsLoading(true);getUser();getTodoList();setIsLoading(false);},[]);if(isLoading){return/*#__PURE__*/_jsx(\"section\",{children:/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"})});}else{return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{name:user.name,setAuthentication:setAuthentication,searchTask:searchTask}),/*#__PURE__*/_jsx(TodoList,{todos:todoList,deleteTodo:deleteTodo}),/*#__PURE__*/_jsx(NewTaskButton,{setTodos:setTodoList,todos:todoList})]});}};export default DashboardPage;","map":{"version":3,"sources":["/Users/nephthalimabebe/Desktop/react-todo/client/src/pages/DashboardPage.js"],"names":["React","useState","useEffect","useHistory","Navbar","NewTaskButton","TodoList","DashboardPage","setAuthentication","todoList","setTodoList","isLoading","setIsLoading","name","user","setUser","token","localStorage","getItem","url","getUser","fetch","method","headers","then","res","status","json","removeItem","data","catch","err","getTodoList","todos","searchTask","searchQuery","console","log","query","searchResult","deleteTodo","id","filter","todo"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { useHistory } from 'react-router-dom'\n\nimport Navbar from '../components/Dashboard/Navbar'\nimport NewTaskButton from '../components/Dashboard/NewTaskButton'\nimport TodoList from '../components/Dashboard/TodoList'\n\nconst DashboardPage = ({ setAuthentication }) => {\n\n    const [todoList, setTodoList] = useState([]);\n    const [isLoading, setIsLoading] = useState(true);\n    const [user, setUser] = useState({ name: \"\" });\n    const token = localStorage.getItem(\"token\")\n    const url = \"https://nephthalim-react-todo.herokuapp.com\"\n\n    const getUser = () => {\n        fetch(\n            url + \"/\",\n            {\n                method: 'GET',\n                headers: {\n                    'token': token,\n                }\n            }\n\n        ).then((res) => {\n            if (res.status === 200) return res.json();\n            else if (res.status === 403) {\n                localStorage.removeItem('token')\n                setAuthentication(false)\n\n            }\n\n        }).then((data) => {\n            setUser({ name: data.name })\n\n        }).catch((err) => {\n            localStorage.removeItem('token')\n            setAuthentication(false)\n        })\n    }\n    const getTodoList = () => {\n        fetch(\n            url + \"/todo\",\n            {\n                method: 'GET',\n                headers: {\n                    'token': token,\n                }\n            }\n        ).then((res) => {\n            return res.json();\n        }).then((data) => {\n            setTodoList(data.todos)\n        }).catch((err) => {\n            localStorage.removeItem('token')\n            setAuthentication(false)\n        })\n\n    }\n\n    const searchTask = (searchQuery) => {\n        console.log(`Searching ${searchQuery}`)\n        fetch(\n            url + '/search?query=' + searchQuery.query,\n            {\n                method: \"GET\",\n                headers:\n                {\n                    'Content-Type': \"application/json\",\n                    \"token\": token\n                }\n            }).then((res) => {\n                return res.json()\n            }).then((data) => {\n                setTodoList(data.searchResult)\n            }).catch((err) => {\n                localStorage.removeItem('token')\n                setAuthentication(false)\n            })\n    }\n\n    const deleteTodo = (id) => {\n        setTodoList(todoList.filter(todo => todo.id !== id))\n    }\n\n    useEffect(() => {\n        console.log(\"DahsboardPage.js\")\n        setIsLoading(true);\n        getUser();\n        getTodoList();\n        setIsLoading(false);\n    }, [])\n    if (isLoading) {\n        return (\n            <section>\n                <p>Loading...</p>\n            </section>\n        );\n    }\n    else {\n        return (\n            <>\n                <Navbar name={user.name} setAuthentication={setAuthentication} searchTask={searchTask} />\n                {/* <Navbar name={\"Nephy\"} setAuthentication={setAuthentication} searchTask={searchTask} /> */}\n                <TodoList todos={todoList} deleteTodo={deleteTodo} />\n                <NewTaskButton setTodos={setTodoList} todos={todoList}/>\n\n\n            </>\n        )\n\n    }\n}\n\nexport default DashboardPage\n"]},"metadata":{},"sourceType":"module"}