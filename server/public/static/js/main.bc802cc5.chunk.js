(this["webpackJsonpreact-todo"]=this["webpackJsonpreact-todo"]||[]).push([[0],{37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){"use strict";n.r(t);var c=n(1),o=n(14),s=n.n(o),a=n(5),r=n(3),i=n(9),l=n(2),j=function(e){var t=e.loginUser,n=Object(c.useState)(""),o=Object(a.a)(n,2),s=(o[0],o[1]),j=(Object(r.g)(),Object(c.useRef)()),u=Object(c.useRef)();return Object(l.jsx)("div",{children:Object(l.jsxs)("form",{className:"w-50 mx-auto",children:[Object(l.jsx)("input",{ref:j,type:"email",className:"form-control my-3",name:"email",placeholder:"Email"}),Object(l.jsx)("input",{ref:u,type:"password",className:"form-control my-3",name:"password",placeholder:"Password"}),Object(l.jsx)("input",{type:"submit",className:"btn btn-primary w-100 my-3",onClick:function(e){e.preventDefault();var n={email:j.current.value,password:u.current.value},c=JSON.stringify(n);t(c,s)}}),Object(l.jsx)(i.b,{to:"/register",children:Object(l.jsx)("button",{type:"button",className:"btn btn-success w-100 my-3",children:"Register"})})]})})},u=(n(23),function(e){var t=e.setAuthentication,n=e.toaster;return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("h1",{className:"text-center my-5",children:"Login"}),Object(l.jsx)(j,{loginUser:function(e){fetch("/auth/login",{method:"POST",body:e,headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){if(200===e.status)return e.json();401===e.status?n.error("\ud83d\ude41 Please make sure you are using the right credentials!"):500===e.status&&n.error("\ud83d\ude41 Seems like there is a server error \u2639\ufe0f! Try again some other time")})).then((function(e){e.token&&(localStorage.setItem("token",e.token),n.success(),t(!0))})).catch((function(e){console.log(e)}))}})]})}),d=(n(37),n(38),function(e){var t=e.searchTask,n=Object(c.useRef)();return Object(l.jsx)("form",{className:"searchBar",children:Object(l.jsx)("input",{ref:n,className:"form-control mr-sm-2",type:"search",placeholder:"Search","aria-label":"Search",onChange:function(e){e.preventDefault();var c=n.current.value;t({query:c})}})})}),m=function(e){var t=e.name,n=e.setAuthentication,c=e.searchTask;return Object(l.jsxs)("div",{className:"navbar-collapse _navbar",children:[Object(l.jsx)("h1",{className:"_nav-name",children:t.toUpperCase()}),Object(l.jsx)(d,{searchTask:c}),Object(l.jsx)("button",{className:"_nav-btn",onClick:function(e){e.preventDefault(),localStorage.removeItem("token"),n(!1)},children:" Logout "})]})},b=n(26),h=n(25),f=(n(39),n(40),function(e){var t=e.text,n=e.onConfirm,o=e.onClose,s=e.data,a=Object(c.useRef)(),r=Object(c.useRef)(),i=function(e){e.preventDefault();var t={name:a.current.value,description:r.current.value};console.log(t),n(t),o()};return Object(l.jsxs)("div",{className:"-modal",children:[Object(l.jsx)("p",{children:t}),Object(l.jsx)("form",{className:"form",children:s?Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)("div",{className:"form-item",children:[Object(l.jsx)("label",{children:"Name"}),Object(l.jsx)("input",{ref:a,className:"form-input form-control",type:"text",defaultValue:s.name})]}),Object(l.jsxs)("div",{className:"form-item",children:[Object(l.jsx)("label",{children:"Description"}),Object(l.jsx)("input",{ref:r,className:"form-input form-control",type:"text",defaultValue:s.description})]}),Object(l.jsxs)("div",{className:"form-btns",children:[Object(l.jsx)("input",{type:"submit",className:"-btn",title:"Confirm",onClick:i}),Object(l.jsx)("button",{className:"-btn -btn--alt",onClick:o,children:"Cancel"})]})]}):Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)("div",{className:"form-block",children:[Object(l.jsx)("input",{className:"form-input form-control",type:"text",ref:a,placeholder:"Name"}),Object(l.jsx)("input",{className:"form-input form-control",type:"text",ref:r,placeholder:"Description"})]}),Object(l.jsxs)("div",{className:"form-btns",children:[Object(l.jsx)("input",{type:"submit",className:"-btn",title:"Confirm",onClick:i}),Object(l.jsx)("button",{className:"-btn -btn--alt",onClick:o,children:"Cancel"})]})]})})]})}),p=(n(41),function(e){var t=e.onClick;return Object(l.jsx)("div",{className:"backdrop",onClick:t})}),O=function(e){var t=e.setTodos,n=e.todos,o=Object(c.useState)(!1),s=Object(a.a)(o,2),r=s[0],i=s[1],j=localStorage.getItem("token");function u(){i(!1)}return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("div",{className:"-btn_add",onClick:function(){i(!0)},children:Object(l.jsx)(h.a,{})}),r&&Object(l.jsx)(p,{onClick:u}),r&&Object(l.jsx)(f,{text:"Add",onClose:u,onConfirm:function(e){fetch("https://nephthalim-react-todo.herokuapp.com/todo",{method:"POST",body:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json",token:j}}).then((function(e){if(200===e.status)return e.json();403===e.status&&localStorage.removeItem("token")})).then((function(e){t([].concat(Object(b.a)(n),[e.todo]))}))}})]})},x=n(21),g=n(20),v=(n(42),n(43),function(e){var t=e.showModalHandler,n=e.deleteTodo;return Object(l.jsxs)("div",{className:"popup",children:[Object(l.jsx)("a",{onClick:t,children:"Edit"}),Object(l.jsx)("a",{onClick:n,children:"Delete"})]})}),k=function(e){e.key;var t=e.task,n=e.deleteTodo,o="https://nephthalim-react-todo.herokuapp.com",s=localStorage.getItem("token"),r=Object(c.useState)(!1),i=Object(a.a)(r,2),j=i[0],u=i[1],d=Object(c.useState)(!1),m=Object(a.a)(d,2),b=m[0],h=m[1],O=Object(c.useState)(!1),k=Object(a.a)(O,2),y=k[0],N=k[1],C=Object(c.useState)(!1),S=Object(a.a)(C,2),T=S[0],w=S[1];function A(){w(!1)}Object(c.useEffect)((function(){u(t.important),h(t)}),[]);return Object(l.jsxs)("div",{className:"container ".concat(j?"important":null),onDoubleClick:function(){T||function(e){var t=localStorage.getItem("token");fetch(o+"/todo/important/"+e,{method:"PUT",headers:{token:t,Accept:"application/json","Content-Type":"application/json"}}).then((function(e){if(200===e.status)return e.json();403===e.status&&localStorage.removeItem("token")})).then((function(){u(!j)}))}(b.id)},children:[Object(l.jsxs)("div",{className:"header",children:[Object(l.jsx)("h3",{children:b.name}),Object(l.jsx)("div",{onClick:function(){N(!y)},children:y?Object(l.jsx)(g.a,{}):Object(l.jsx)(g.b,{})})]}),Object(l.jsx)("div",{children:y?Object(l.jsx)(v,{deleteTodo:function(e){e.preventDefault(),fetch(o+"/todo/"+b.id,{method:"DELETE",headers:{token:s}}).then((function(e){if(200===e.status)return e.json();403===e.status&&localStorage.removeItem("token")})).then((function(){n(b.id)}))},showModalHandler:function(){w(!0)}}):null}),Object(l.jsx)("p",{className:"description",children:b.description}),Object(l.jsx)("div",{className:"date",children:b.date_created}),T&&Object(l.jsx)(p,{onClick:A}),T&&Object(l.jsx)(f,{text:"Edit",onClose:A,data:b,onConfirm:function(e){fetch(o+"/todo/"+b.id,{method:"PUT",body:JSON.stringify(e),headers:{Accept:"application/json","Content-Type":"application/json",token:s}}).then((function(e){if(200===e.status)return e.json();403===e.status&&localStorage.removeItem("token")})).then(h(Object(x.a)(Object(x.a)({id:b.id},e),{},{important:b.important,date_created:b.date_created})))}})]})},y=(n(44),function(e){var t=e.todos,n=e.deleteTodo;return Object(l.jsx)(l.Fragment,{children:Object(l.jsx)("div",{className:"grid",children:t.map((function(e){return Object(l.jsx)(k,{task:e,deleteTodo:n},e.id)}))})})}),N=function(e){var t=e.setAuthentication,n=Object(c.useState)([]),o=Object(a.a)(n,2),s=o[0],r=o[1],i=Object(c.useState)(!0),j=Object(a.a)(i,2),u=j[0],d=j[1],b=Object(c.useState)({name:""}),h=Object(a.a)(b,2),f=h[0],p=h[1],x=localStorage.getItem("token");return Object(c.useEffect)((function(){d(!0),fetch("/todo",{method:"GET",headers:{token:x,"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){if(200===e.status)return e.json();403===e.status&&(localStorage.removeItem("token"),t(!1))})).then((function(e){p({name:e.name})})).catch((function(e){console.log(e),localStorage.removeItem("token"),t(!1)})),fetch("/todo/all",{method:"GET",headers:{token:x,"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){r(e.todos)})).catch((function(e){console.log(e),localStorage.removeItem("token"),t(!1)})),d(!1)}),[]),u?Object(l.jsx)("section",{children:Object(l.jsx)("p",{children:"Loading..."})}):Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(m,{name:f.name,setAuthentication:t,searchTask:function(e){fetch("/todo/search?query="+e.query,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json",token:x}}).then((function(e){return e.json()})).then((function(e){r(e.searchResult)})).catch((function(e){localStorage.removeItem("token"),t(!1)}))}}),Object(l.jsx)(y,{todos:s,deleteTodo:function(e){r(s.filter((function(t){return t.id!==e})))}}),Object(l.jsx)(O,{setTodos:r,todos:s})]})},C=function(e){var t=e.addUser,n=Object(c.useRef)(),o=Object(c.useRef)(),s=Object(c.useRef)();return Object(l.jsxs)("form",{className:"w-50 mx-auto",children:[Object(l.jsx)("input",{ref:n,type:"text",className:"form-control my-3",name:"name",placeholder:"Name"}),Object(l.jsx)("input",{ref:o,type:"email",className:"form-control my-3",name:"email",placeholder:"Email"}),Object(l.jsx)("input",{ref:s,type:"password",className:"form-control my-3",name:"password",placeholder:"Password"}),Object(l.jsx)("input",{type:"submit",className:"btn btn-primary w-100",onClick:function(e){e.preventDefault();var c={name:n.current.value.toString(),email:o.current.value.toString(),password:s.current.value.toString()},a=JSON.stringify(c);t(a)}})]})},S=function(e){var t=e.setAuthentication,n=Object(r.g)();return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("h1",{className:"text-center my-5",children:"Register"}),Object(l.jsx)(C,{addUser:function(e){fetch("/auth/register",{method:"POST",body:e,headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){if(200===e.status)return e.json()})).then((function(e){localStorage.setItem("token",e.token),t(!0)})).catch((function(e){console.log("Error"),console.log(e),n.replace("/register")}))}})]})},T=n(13);n(45);var w=function(){var e=Object(c.useState)(!1),t=Object(a.a)(e,2),n=t[0],o=t[1],s=localStorage.getItem("token");Object(c.useEffect)((function(){s&&""!=s&&void 0!=s&&o(!0)}));var i={success:function(){return T.b.success("\ud83c\udf89 You have successfuly logged in.",{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})},error:function(e){return T.b.error(e,{position:"bottom-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}};return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)(r.d,{children:[Object(l.jsx)(r.b,{path:"/",exact:!0,children:n?Object(l.jsx)(N,{setAuthentication:o}):Object(l.jsx)(u,{setAuthentication:o,toaster:i})}),Object(l.jsx)(r.b,{path:"/register",exact:!0,children:n?Object(l.jsx)(r.a,{to:"/"}):Object(l.jsx)(S,{setAuthentication:o})})]}),Object(l.jsx)(T.a,{position:"bottom-right",autoClose:2500,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0})]})};s.a.render(Object(l.jsx)(i.a,{children:Object(l.jsx)(w,{})}),document.getElementById("root"))}},[[46,1,2]]]);
//# sourceMappingURL=main.bc802cc5.chunk.js.map